<fieldset [formGroup]="formGroup">
  <h3>{{ heading }}</h3>

  <div
    [formArrayName]="direction"
    cdkDropList
    [cdkDropListData]="formArray"
    [cdkDropListEnterPredicate]="enterPredicate"
  >
    <!--
      @angular/cdk/drag-drop applies a transform style to list elements in
      order to preview sorting while dragging.
      For some reason, this style has no effect when directly applied to the
      child component, so the expense component has to be wrapped in a div.
    -->
    <div
      *ngFor="let expenseForm of formArray.controls; index as i"
      cdkDrag
      [cdkDragData]="expenseForm"
      (cdkDragDropped)="drop($event)"
    >
      <app-expense-list-row
        [form]="expenseForm"
        [index]="i"
        (deleteRow)="deleteExpense($event)"
      />
    </div>
  </div>

  <div class="button-group">
    <button (click)="openAddExpenseDialog()">Auslage hinzufügen</button>
    <button *ngIf="extraButton" (click)="onClickExtraButton($event)">
      {{ extraButton }}
    </button>
  </div>

  <div *ngIf="formArray.hasError('maxPlanExpenses')" class="error-message">
    Du kannst pro Fahrtrichtung maximal eine Auslage für Abo Tickets angeben.
  </div>
</fieldset>
